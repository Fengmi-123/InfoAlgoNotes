# 线性基

线性基在 $ACM$ 中主要用于解决一堆数异或的问题的数据结构，如任意数异或的最大最小值，是否能表示出某个值，第 $K$ 小等。主要复杂度与其二进制位数有关

```c++
ll a[66],d[66],cnt;//d为重构后线性基，可快速求出第k大，且必须重构
void ins(ll x){
	for(ll i=60;~i;i--){//60为最高位数
		if(x&(1ll<<i)){
			if(!a[i]){
				a[i]=x;return;
			}
			else x=x^a[i];
		}
	}
}
bool check(ll x){
	for(ll i=60;~i;i--){
		if(x&(1ll<<i)){
			if(!a[i]){
				return 0;
			}
			else x=x^a[i];
		}
	}
	return 1;
}
ll qmax(){
	ll res=0;
	for(ll i=60;~i;i--){
		res=max(res,res^a[i]);
	}
	return res;
}
void rebuild(){
	for(int i = 63;i >= 0;i--)
		for(int j = i-1;j >= 0;j--)
			if(a[i]&(1LL<<j)) a[i]^=a[j];
	for(int i=0;i<=63;i++) if(a[i]) d[cnt++]=a[i];
}
int kth(int k){
	if(k >= (1LL<<cnt)) return -1;
	int ans=0;
	for(int i = 62;i>=0;i--)
	{
		if((k>>i)&1) ans^=d[i];
	}
	return ans;
}


```




